<!DOCTYPE html>
<html>
<head>
	<title>Snake Game</title>
	<meta name="viewport" content="width=device-width">
	<link rel="stylesheet" type="text/css" href="style.css?8">
	<script type="text/javascript" src="drawing.js?8"></script>
	<script type="text/javascript" src="game.js?8"></script>
	<script type="text/javascript" src="snake.js?8"></script>
</head>
<body>

<canvas id="mycanvas" width="640" height="480">
	
</canvas>

<div class="control-buttons">
	<div id="arrow_up"></div>
	<div class="horizontal-buttons">
		<div id="arrow_left"></div><div id="arrow_right"></div>
	</div>
	<div id="arrow_down"></div>
</div>

<script type="text/javascript">
"use strict";
(function () {

	var game = new SnakeGame(new window.Drawing('mycanvas'));
	var snake = new SnakeGame.Snake(game, 100, 100);
	var food = {x: 0, y: 0};

	game.drawing.stroke('#140c1c');
	game.drawing.font('16px "Lucida Console", Monaco, monospace')

	game.logic = function () {

		if (snake.eat(food)) {
			game.score += 10;
			spawnNewFood();
		}

		snake.death();
		snake.update();
		snake.draw();

		drawFood();
		drawScore();
	};

	game.addKeydown(function (event) {
		const UP = 38;
		const DOWN = 40;
		const LEFT = 37;
		const RIGHT = 39;

		var keyCode = event.keyCode;
		if (keyCode == UP) {
			snake.dir(0, -1);
		} else if (keyCode == DOWN) {
			snake.dir(0, 1);
		} else if (keyCode == LEFT) {
			snake.dir(-1, 0);
		} else if (keyCode == RIGHT) {
			snake.dir(1, 0);
		}
	});

	// touch/button controls
	document.getElementById('arrow_up').addEventListener('click', function (event) {
		snake.dir(0, -1);
	});
	document.getElementById('arrow_down').addEventListener('click', function (event) {
		snake.dir(0, 1);
	});
	document.getElementById('arrow_left').addEventListener('click', function (event) {
		snake.dir(-1, 0);
	});
	document.getElementById('arrow_right').addEventListener('click', function (event) {
		snake.dir(1, 0);
	});


	spawnNewFood();

	game.start();

	function spawnNewFood() {
		var cols = game.width / game.scl;
		var rows = game.height / game.scl;
		food.x = getRandomInt(1, cols - 2) * game.scl;
		food.y = getRandomInt(1, rows - 2) * game.scl;
	}
	function drawFood() {
		game.drawing.rect(food.x, food.y, game.scl, game.scl, '#d04648');
	}

	function getRandomInt(min, max)
	{
	  return Math.floor(Math.random() * (max - min + 1)) + min;
	}

	function drawScore() {
		game.drawing.fill('#140c1c');
		game.drawing.text(5, game.height - 5, 'score: ' + game.score);
	}


})();
</script>
</body>
</html>
